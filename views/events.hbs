
    {{>top-nav}}
    
    <div class="container">
        <div id="main-header">
            <h2>Attendees</h2>
            <div>
                <button onclick="location.href='/dbtester'" type="button">+ New Event</button>
                <select name="event-name" id="event-name" >
                    {{#each events}}
                        <option value="{{this.name}}" id="{{this.name}}" data-eventid="{{this.eventID}}">{{this.name}}</option>
                    {{/each}}
                </select>
            </div>
        </div>
        <div>
            <button>Add User</button>
            <button>Pending Reports</button>
        </div>
        <div class="content">      
            <div class="left">
                <div class="search">
                    <input placeholder="Find by name"> 

                    <button>Search</button>
                    <select name="id-num" id="id-num">
                        <option value="mercedes">Mercedes</option>
                        <option value="audi">Audi</option>
                    </select>
                    <select name="position" id="position">
                        <option value="mercedes">Mercedes</option>
                        <option value="audi">Audi</option>
                    </select>
                    <select name="status" id="status">
                        <option value="mercedes">Mercedes</option>
                        <option value="audi">Audi</option>
                    </select>
                </div>
                
                <div class="table">
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Position</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Boyer, Tristan</td>
                                <td>boyer_tristan@dlsu.edu.ph</td>
                                <td>officer</td>
                            </tr>
                            <tr>
                                <td>Boyer, Tristan</td>
                                <td>boyer_tristan@dlsu.edu.ph</td>
                                <td>officer</td>
                            </tr>
                            <tr>
                                <td>Boyer, Tristan</td>
                                <td>boyer_tristan@dlsu.edu.ph</td>
                                <td>officer</td>
                            </tr>
                            <tr>
                                <td>Boyer, Tristan</td>
                                <td>boyer_tristan@dlsu.edu.ph</td>
                                <td>officer</td>
                            </tr>
                            <tr>
                                <td>Boyer, Tristan</td>
                                <td>boyer_tristan@dlsu.edu.ph</td>
                                <td>officer</td>
                            </tr>
                            <tr>
                                <td>Boyer, Tristan</td>
                                <td>boyer_tristan@dlsu.edu.ph</td>
                                <td>officer</td>
                            </tr>
                            <tr>
                                <td>Boyer, Tristan</td>
                                <td>boyer_tristan@dlsu.edu.ph</td>
                                <td>officer</td>
                            </tr>
                            <tr>
                                <td>Boyer, Tristan</td>
                                <td>boyer_tristan@dlsu.edu.ph</td>
                                <td>officer</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="event-tracker">
                <div class="event-header">
                    <div class="event-name">
                        <span>GDSC Dev Fest</span>
                    </div>
                    <button class="edit-btn">EDIT</button>
                </div>   
                <div id="event-type">
                    Event Type
                </div>
                <div class="event-body">
                <div id="event-details" class="event-details" style="display: none;">
                    <div class="info-item">
                        <span class="label">Date</span>
                        <span id="event-date" class="value" id="date"></span>
                    </div>
                    <div class="info-item">
                        <span class="label">Venue</span>
                        <span id="event-venue" class="value" id="venue"></span>
                    </div>
                    <div class="info-item">
                        <span class="label">Time</span>
                        <span id="event-time" class="value" id="time"></span>
                    </div>
                    <div class="info-item">
                        <span class="label">Attendees Count</span>
                        <span id="event-attendee-count" class="value" id="attendees"></span>
                    </div>
                    <div class="info-item">
                        <span class="label">Project Head</span>
                        <span id="event-project-head" class="value pending" id="project-head"></span>
                    </div>
                </div> 
                <div class="footer">
                    
                </div>
            </div>
        </div>
    <script>
        // show event details upon page load
        document.addEventListener('DOMContentLoaded', async () => {
            const eventSelect = document.getElementById('event-name');
            const selectedEventID = eventSelect.options[eventSelect.selectedIndex].getAttribute('data-eventid');
            await fetchEventDetails(selectedEventID);

            // show event details upon event selection change
            eventSelect.addEventListener('change', async (event) => {
                const selectedEventID = event.target.options[event.target.selectedIndex].getAttribute('data-eventid');
                await fetchEventDetails(selectedEventID);
            });
        });

        async function fetchEventDetails(eventID) {
            try {
                const response = await fetch(`/event/${eventID}`);
                if (response.ok) {
                    const event = await response.json();
                    document.getElementById('event-date').textContent = event.date;
                    document.getElementById('event-venue').textContent = event.venue;
                    document.getElementById('event-time').textContent = event.time;
                    document.getElementById('event-attendee-count').textContent = event.attendeeCount;
                    document.getElementById('event-project-head').textContent = event.projectHeadID;

                    document.getElementById('event-details').style.display = 'block';
                } else {
                    console.error('Error fetching event details:', response.statusText);
                }
            } catch (error) {
                console.error('Error fetching event details:', error);
            }
        }
    </script>
    </div>
